+++
title = "Jackson Auto-Typing Objects"
date = 2012-01-30T14:06:00Z
updated = 2012-01-30T14:07:19Z
tags = ["Code"]
blogimport = true 
[author]
	name = "Sean Wesenberg"
	uri = "https://plus.google.com/111523202047342274226"
+++

I'm using the Jackson JSON framework to do some (de)+serialization for my web app, but as we all know... JSON isn't typed. Here is a quick auto-typer that I created that runs when the app starts up (in tomcat). Look through the resources / references down below for more info.<br /><br /><b>First, create a basic mixin class</b>.<br /><br /><pre class="brush:java">package wookets.json;<br /><br />import org.codehaus.jackson.annotate.JsonTypeInfo;<br />import org.codehaus.jackson.annotate.JsonTypeInfo.As;<br />import org.codehaus.jackson.annotate.JsonTypeInfo.Id;<br /><br />@JsonTypeInfo(use=Id.NAME, include=As.PROPERTY, property="_type")<br />public class JacksonTyping {<br /><br />}<br /></pre><br /><b>Next, create a startup (bootstrap)</b> in your app that runs this code when the app starts in the server. I'm assuming you're using the Spring Framework here.<br /><br /><pre class="brush:java">def scanner = new ClassPathScanner()<br />    scanner.addIncludeFilter(new AnnotationTypeFilter(DomainModel.class))<br />    scanner.addIncludeFilter(new AnnotationTypeFilter(DataTransferObject.class))<br />    for(String path : paths) {<br />      for(Class c: scanner.getComponentClasses(path)) {<br />        log.debug "Adding ${c.simpleName} to json mapper"<br />        objectJsonMarshaller.getSerializationConfig().addMixInAnnotations(c, JacksonTyping.class) // outgoing<br />        objectJsonMarshaller.getDeserializationConfig().addMixInAnnotations(c, JacksonTyping.class) // incoming<br />        //objectJsonMarshaller.registerSubtypes(new NamedType(c, c.simpleName)) // old way<br />      }<br />    }<br /></pre><br />The ClassPathScanner is a nothing more than an extension of the spring class&nbsp;ClassPathScanningCandidateComponentProvider. It in essence will look through your java packages and return each class, which you can filter and inspect and do what have you...<br /><br /><br /><b>Resources</b>:<br /><br /><a href="http://jackson.codehaus.org/">http://jackson.codehaus.org/</a><br /><br /><a href="http://programmerbruce.blogspot.com/2011/05/deserialize-json-with-jackson-into.html">http://programmerbruce.blogspot.com/2011/05/deserialize-json-with-jackson-into.html</a><br />* this is the best reference...<br /><br /><a href="http://stackoverflow.com/questions/5826928/how-can-i-prevent-jackson-from-serializing-a-polymorphic-types-annotation-prope">http://stackoverflow.com/questions/5826928/how-can-i-prevent-jackson-from-serializing-a-polymorphic-types-annotation-prope</a><br /><br /><br />
