+++
title = "Flex Mobile using StageWebView to show docs (ppt, excel, word, pdf)"
date = 2011-05-26T11:08:00Z
updated = 2011-05-26T11:08:42Z
blogimport = true 
[author]
	name = "Sean Wesenberg"
	uri = "https://plus.google.com/111523202047342274226"
+++

If you want to show documents (ppt, xls, rtf, doc, docx, pdf, etc) in your flex mobile application here is some code that should help. Note, this was tested on iOS. Your mileage may vary on andriod, but I assume it will work just fine. This only works because webkit has viewers for these file formats. No editing, just viewing.<br /><br />First - How to download a file from a remote server and store it in the application storage directory. You could also bundle these files with your app, but chances are you want to pull in from a remote source and save the files locally for viewing.<br /><br /><pre style="background: #f0f0f0; border: 1px dashed #CCCCCC; color: black; font-family: arial; font-size: 12px; height: auto; line-height: 20px; overflow: auto; padding: 0px; text-align: left; width: 99%;"><code style="color: black; word-wrap: normal;">    var file:String = "test.xlsx";  <br />    button.addEventListener(MouseEvent.CLICK, function(event:MouseEvent):void {  <br />     var loader:URLLoader = new URLLoader();  <br />     loader.dataFormat = URLLoaderDataFormat.BINARY;  <br />     loader.addEventListener(Event.COMPLETE,  <br />      function(e:Event):void {  <br />       var air:File = File.applicationStorageDirectory.resolvePath(file);  <br />       var fs:FileStream = new FileStream();  <br />       fs.open(air, FileMode.WRITE);  <br />       fs.writeBytes(loader.data);  <br />       fs.close();  <br />      });  <br />     loader.load(new URLRequest("http://wookets.com/"+file));  <br />    });  <br /></code></pre><br /><br />Next show the file - This uses webkit behind the scenes to display the file. So the finished pinching / zooming will replicate safari.<br /><br /><pre style="background: #f0f0f0; border: 1px dashed #CCCCCC; color: black; font-family: arial; font-size: 12px; height: auto; line-height: 20px; overflow: auto; padding: 0px; text-align: left; width: 99%;"><code style="color: black; word-wrap: normal;"> button.addEventListener(MouseEvent.CLICK, function(event:MouseEvent):void {  <br />     // show a stage web view  <br />     var yOffset:Number = 40;  <br />     var stageWebView:StageWebView = new StageWebView;  <br />     stageWebView.stage = stage;  <br />     stageWebView.viewPort = new Rectangle(0, yOffset, stage.width, stage.fullScreenHeight - yOffset);  <br />     var pdf:File = File.applicationStorageDirectory.resolvePath(file);  <br />     stageWebView.loadURL(pdf.nativePath);  <br />    });  <br /></code></pre><br /><br />Of note:<br /><br />There is a method on the File class called openWithDefaultApplication(). It does NOT work on mobile devices. The method will not do anything, just silently fail. Go to ideas.adobe.com and vote this up, because this feature is critical for allowing other apps to be able to open and handle documents.<br /><br />It's not a lot of code, but it took me quite too long to figure all of this out. So, hopefully, this helps you.<br /><br />Btw, if you want a download of some source code, I can zip it up and provide that. Sorry, this one isn't as demoable as the others.
