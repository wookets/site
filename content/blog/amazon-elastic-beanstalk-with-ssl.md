+++
title = "Amazon Elastic Beanstalk with SSL"
date = 2011-11-11T08:52:00Z
updated = 2011-11-11T09:19:09Z
tags = ["Architecture"]
blogimport = true 
[author]
	name = "Sean Wesenberg"
	uri = "https://plus.google.com/111523202047342274226"
+++

When you deploy your first elastic beanstalk application the URL will similar to...<br /><br />http://myapp-cname.elasticbeanstalk.com<br /><br /><div>Where 'myapp-cname' is the assigned cname when you first launch your environment.&nbsp;</div><div><br /></div><div>What if we want to resolve our own domain, e.g.&nbsp;</div><div><br /></div><div>http://myapp.yourdomain.com</div><div><br /></div><div>This is pretty straight forward (assuming some background in working with cnames)...&nbsp;</div><div><br /></div><div><b>CNAME</b></div><div><br /></div><div>1. Go into the Amazon AWS console and locate the elastic load balancer. This is generally found under EC2 -&gt; load balancers.&nbsp;</div><div><br /></div><div class="separator" style="clear: both; text-align: center;"><a href="https://img.skitch.com/20111111-tjx6yxat8u7yi6y2n1j3ufrpjb.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="191" src="https://img.skitch.com/20111111-tjx6yxat8u7yi6y2n1j3ufrpjb.jpg" width="320" /></a></div><div><br /></div><div><br /></div><div>2. Take the DNS name of the load balancer. This will be your cname record on your domain host.&nbsp;</div><div><br /></div><div>Example:&nbsp;</div><div><br /></div><div>alias: myapp.yourdomain.com</div><div>cname: myapp-cname.elasticbeanstalk.com</div><div><br /></div><div><br /></div><div><b>Adding SSL&nbsp;</b></div><div><br /></div><div>SSL (HTTPS) is a little more tricky.&nbsp;</div><div><br /></div><div>1. You need to create a certificate and have it signed by an authority. This steps is far beyond this post, but if you google or look in Amazon's docs, they'll help you out.&nbsp;</div><div><br /></div><div>2. Once you have your cert and your private key, you need to upload those to IAM. IAM is Amazon's&nbsp;Identity&nbsp;and Access Management cloud service. This requires some command line work, as the AWS console does not currently support any way to upload this...&nbsp;</div><div><br /></div><div>See...&nbsp;<a href="http://docs.amazonwebservices.com/IAM/latest/UserGuide/index.html?ManagingServerCerts.html">http://docs.amazonwebservices.com/IAM/latest/UserGuide/index.html?ManagingServerCerts.html</a></div><div><br /></div><div>3. Now, you need to change your load balancer config on your elastic beanstalk environment to point to this certificate. This requires enabling https and setting the aws certificate id on your elastic beanstalk load balancer config.</div><div><br /></div><div>See...&nbsp;<a href="http://docs.amazonwebservices.com/elasticbeanstalk/latest/dg/index.html?using-features.managing.elb.html">http://docs.amazonwebservices.com/elasticbeanstalk/latest/dg/index.html?using-features.managing.elb.html</a></div><div><br /></div><div>4. Then, assuming you did the above (add the cname for http) everything should work.&nbsp;</div><div><br /></div><div><b>Things to note</b></div><div><br /></div><div>The load balancer is doing the SSL termination and handling the overhead and processing associated with that... That's why we had to upload it and point the cname to the balancer. Your elastic beanstalk environment (the actual server) doesn't do any SSL stuff, which is nice, because it means more CPU for your apps.&nbsp;</div><div><br /></div><div>There is an issue with root type cnames. e.g. mydomain.com (instead of www.mydomain.com)... but there is a work around by setting up an Amazon Route 53 alias.&nbsp;</div><div><br /></div><div>In case you are wondering, for each environment, you need one sub-domain. Because, we are pointing to the load balancer and every elastic beanstalk environment creates a new load balancer. Maybe one day Amazon will add a routing cloud service, so you could point to a load balancer, which points to other load balancers, which point to your apps... Thus, you could in theory have one subdomain and use a path variable to do the routing through the system. But, that's a bit more complicated than we need to make things... (though it would be nice not to muck with DNS records as much)</div><div><br /></div><div><br /></div><div><br /></div><div><b>Resources</b></div><div><br /></div><div><a href="http://docs.amazonwebservices.com/Route53/latest/DeveloperGuide/index.html?HowToAliasRRS.html">http://docs.amazonwebservices.com/Route53/latest/DeveloperGuide/index.html?HowToAliasRRS.html</a></div><div><br /></div><div><a href="http://docs.amazonwebservices.com/elasticbeanstalk/latest/dg/index.html?using-features.managing.elb.html">http://docs.amazonwebservices.com/elasticbeanstalk/latest/dg/index.html?using-features.managing.elb.html</a></div><div><br /></div><div><a href="http://docs.amazonwebservices.com/ElasticLoadBalancing/latest/DeveloperGuide/index.html?using-domain-names-with-elb.html">http://docs.amazonwebservices.com/ElasticLoadBalancing/latest/DeveloperGuide/index.html?using-domain-names-with-elb.html</a></div>
